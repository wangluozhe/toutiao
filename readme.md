# å‰è¨€
ä»»ä½•çˆ¬è™«å·¥ç¨‹å¸ˆåœ¨çˆ¬å–ç½‘ç«™æ•°æ®ä¹‹å‰éƒ½ä¼šå¯¹ç½‘ç«™è¿›è¡Œåˆ†æï¼Œå¹¶ä¸”è¿›è¡Œ==é€†å‘(js)ç ´è§£(åŠ å¯†)==ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨çˆ¬å–ä»Šæ—¥å¤´æ¡çš„æ–‡ç« å’Œè§†é¢‘æ•°æ®ä¹‹å‰ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦å…ˆåˆ†æä¸€ä¸‹ä»Šæ—¥å¤´æ¡çš„åçˆ¬è™«æœºåˆ¶ä»¥åŠè¿›è¡Œ==é€†å‘(js)ç ´è§£(åŠ å¯†)==ã€‚

# åˆ†æä»Šæ—¥å¤´æ¡
ä»Šæ—¥å¤´æ¡æŸç”¨æˆ·çš„é“¾æ¥ï¼š==https://www.toutiao.com/c/user/3410443345/#mid=3413306633==
![ä»Šæ—¥å¤´æ¡æŸç”¨æˆ·é“¾æ¥](https://img-blog.csdnimg.cn/20191101152616547.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjc5MDc3,size_16,color_FFFFFF,t_70)
æˆ‘ä»¬å°†å¯¹ä»Šæ—¥å¤´æ¡é“¾æ¥è¿›è¡Œè¯¦ç»†çš„åˆ†æï¼Œä»¥ä¸‹ä¸º==åˆ†ææ­¥éª¤ï¼š==
### 1.åˆ†æç½‘ç«™ä¿¡æ¯æ˜¯å¦æ˜¯é™æ€æ•°æ®
æŒ‰==F12==å¼¹å‡ºå¼€å‘è€…ç•Œé¢ï¼Œé€‰æ‹©==NetworkåŒºåŸŸ==ï¼Œä½ ä¼šå‘ç°æœ‰å¾ˆå¤šçš„è¯·æ±‚é“¾æ¥ï¼Œé¼ æ ‡åˆ’åˆ°æœ€ä¸Šé¢ï¼Œç„¶åçœ‹åˆ°æœ‰ä¸€ä¸ªè·Ÿ==ç½‘ç«™URL==ä¸€æ ·çš„é“¾æ¥ï¼Œç‚¹å‡»è¿›å»ã€‚
![æ¼”ç¤ºå›¾](https://img-blog.csdnimg.cn/20191101153216191.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjc5MDc3,size_16,color_FFFFFF,t_70)
![æ¼”ç¤ºå›¾](https://img-blog.csdnimg.cn/20191101153510110.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjc5MDc3,size_16,color_FFFFFF,t_70)
ä»è¿™é‡Œå¾—å‡ºä»Šæ—¥å¤´æ¡ç½‘ç«™çš„æ•°æ®å¹¶ä¸æ˜¯é™æ€æ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è¿›è¡Œä¸‹ä¸€æ­¥åˆ†æã€‚
### 2.åˆ†æç½‘ç«™ä¿¡æ¯æ˜¯å¦ä¸ºAJAXè¯·æ±‚çš„
AJAXè¯·æ±‚æ˜¯ç½‘ç«™é€šè¿‡jsè„šæœ¬å‘èµ·çš„è¯·æ±‚è¿æ¥ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†åœ¨ä¸åˆ·æ–°ç½‘é¡µçš„æƒ…å†µä¸‹å°±èƒ½å®æ—¶çš„æ›´æ–°ç½‘é¡µå†…å®¹ï¼Œä»è€Œåœ¨æ„Ÿè§‰ä¸Šä½ æ˜¯è§‰å¾—ä»–å’Œç½‘é¡µæºç æ‹¼æ¥åœ¨ä¸€èµ·ã€‚

æˆ‘ä»¬å†ä»ä¼—å¤šçš„é“¾æ¥ä¸­è¿›è¡Œç­›é€‰ï¼Œç”±äºAJAXçš„ç±»å‹æ˜¯XHRçš„ï¼Œæ‰€ä»¥åœ¨å¼€å‘è€…æ¨¡å¼é‡Œé¢æˆ‘ä»¬é€‰æ‹©XHRï¼Œå°±èƒ½çœ‹åˆ°åªå‰©ä¸‹å‡ ä¸ªé“¾æ¥äº†ï¼Œç„¶åä»è¿™å‡ ä¸ªé“¾æ¥é‡Œé¢æ‰¾å‡ºä¸ç½‘ç«™å†…å®¹æå…¶ç›¸ç¬¦çš„é“¾æ¥å°±å¯ä»¥äº†ã€‚
![æ¼”ç¤ºå›¾](https://img-blog.csdnimg.cn/20191101154655910.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjc5MDc3,size_16,color_FFFFFF,t_70)
è¿™æ ·åˆ†æå‡ºæ¥äº†ç½‘ç«™çš„å†…å®¹ä¸»è¦é AJAXè¯·æ±‚çš„æ•°æ®æ¥æ˜¾ç¤ºçš„ã€‚
### 3.åˆ†æè¯·æ±‚é“¾æ¥
æˆ‘ä»¬çŸ¥é“è¿™ä¸ªé“¾æ¥åå°±ä¼šè¦å»è¯·æ±‚è¿™ä¸ªé“¾æ¥ï¼Œä»è€Œåœ¨é‡Œé¢è·å–åˆ°è‡ªå·±æƒ³è¦çš„æ•°æ®ï¼Œè¿™æ ·æˆ‘ä»¬å°±è·å¾—äº†æ•°æ®ã€‚

æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹==å¼€å‘è€…å·¥å…·==ä¸­çš„==NetworkåŒºåŸŸ==çš„==HeadersåŒºåŸŸ==ï¼Œç»è¿‡ä¸¤æ¬¡åˆ·æ–°ç½‘é¡µä¼šå‘ç°ä¸¤æ¬¡è¯·æ±‚ä¸­çš„å‚æ•°æ˜¯æœ‰å˜åŒ–çš„ï¼Œä»¥åŠRequest Headersçš„å‚æ•°ä¹Ÿæ˜¯æœ‰å˜åŒ–çš„ï¼Œçœ‹å›¾ã€‚
ç¬¬ä¸€æ¬¡è¯·æ±‚ï¼š
![ç¬¬ä¸€æ¬¡è¯·æ±‚](https://img-blog.csdnimg.cn/20191101160014877.png)
![ç¬¬ä¸€æ¬¡è¯·æ±‚](https://img-blog.csdnimg.cn/20191101160035641.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjc5MDc3,size_16,color_FFFFFF,t_70)
ç¬¬äºŒæ¬¡è¯·æ±‚ï¼š
![ç¬¬äºŒæ¬¡è¯·æ±‚](https://img-blog.csdnimg.cn/20191101160056345.png)
![ç¬¬äºŒæ¬¡è¯·æ±‚](https://img-blog.csdnimg.cn/20191101160109613.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjc5MDc3,size_16,color_FFFFFF,t_70)
èµ–åŠ è½½è¯·æ±‚ï¼š

è§£é‡Š(ç™¾åº¦ç™¾ç§‘)ï¼šåœ¨Webåº”ç”¨ç¨‹åºä¸­ï¼Œç³»ç»Ÿçš„ç“¶é¢ˆå¸¸åœ¨äºç³»ç»Ÿçš„å“åº”é€Ÿåº¦ã€‚å¦‚æœç³»ç»Ÿå“åº”é€Ÿåº¦è¿‡æ…¢ï¼Œç”¨æˆ·å°±ä¼šå‡ºç°åŸ‹æ€¨æƒ…ç»ªï¼Œç³»ç»Ÿçš„ä»·å€¼ä¹Ÿå› æ­¤ä¼šå¤§æ‰“æŠ˜æ‰£ã€‚å› æ­¤ï¼Œæé«˜ç³»ç»Ÿå“åº”é€Ÿåº¦ï¼Œæ˜¯éå¸¸é‡è¦çš„ã€‚
Webåº”ç”¨ç¨‹åºåšçš„æœ€å¤šå°±æ˜¯å’Œåå°æ•°æ®åº“äº¤äº’ï¼Œè€ŒæŸ¥è¯¢æ•°æ®åº“æ˜¯ç§éå¸¸è€—æ—¶çš„è¿‡ç¨‹ã€‚å½“æ•°æ®åº“é‡Œè®°å½•è¿‡å¤šæ—¶ï¼ŒæŸ¥è¯¢ä¼˜åŒ–æ›´æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚ä¸ºäº†è§£å†³è¿™ç§é—®é¢˜ï¼Œæœ‰äººæå‡ºäº†ç¼“å­˜çš„æ¦‚å¿µã€‚ç¼“å­˜å°±æ˜¯å°†ç”¨æˆ·é¢‘ç¹ä½¿ç”¨çš„æ•°æ®æ”¾åœ¨å†…å­˜ä¸­ä»¥ä¾¿å¿«é€Ÿè®¿é—®ã€‚åœ¨ç”¨æˆ·æ‰§è¡Œä¸€æ¬¡æŸ¥è¯¢æ“ä½œåï¼ŒæŸ¥è¯¢çš„è®°å½•ä¼šæ”¾åœ¨ç¼“å­˜ä¸­ã€‚å½“ç”¨æˆ·å†æ¬¡æŸ¥è¯¢æ—¶ï¼Œç³»ç»Ÿä¼šé¦–å…ˆä»ç¼“å­˜ä¸­è¯»å–ï¼Œå¦‚æœç¼“å­˜ä¸­æ²¡æœ‰ï¼Œå†æŸ¥è¯¢æ•°æ®åº“ã€‚ç¼“å­˜æŠ€æœ¯åœ¨ä¸€å®šç¨‹åº¦ä¸Šæå‡äº†ç³»ç»Ÿæ€§èƒ½ï¼Œä½†æ˜¯å½“æ•°æ®é‡è¿‡å¤§æ—¶ï¼Œç¼“å­˜å°±ä¸å¤ªåˆé€‚äº†ã€‚å› ä¸ºå†…å­˜å®¹é‡æœ‰é™ï¼ŒæŠŠè¿‡å¤šçš„æ•°æ®æ”¾åœ¨å†…å­˜ä¸­ï¼Œä¼šå½±å“ç”µè„‘æ€§èƒ½ã€‚è€Œå¦ä¸€ç§æŠ€æœ¯ï¼Œæ‡’åŠ è½½å¯ä»¥è§£å†³è¿™ç§é—®é¢˜ã€‚
![èµ–åŠ è½½è¯·æ±‚](https://img-blog.csdnimg.cn/20191101163941394.png)
![èµ–åŠ è½½è¯·æ±‚](https://img-blog.csdnimg.cn/20191101164001232.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjc5MDc3,size_16,color_FFFFFF,t_70)
ä»ä¸Šé¢å›¾ç‰‡æ¥çœ‹ï¼Œæˆ‘ä»¬å°±èƒ½å‘ç°é“¾æ¥çš„å‚æ•°å’Œè¯·æ±‚çš„headersçš„å‚æ•°æ˜¯æœ‰å˜åŒ–çš„ã€‚
å˜åŒ–å‚æ•°çš„ä½œç”¨ï¼š
|å‚æ•°|ä½œç”¨|åŠ å¯†|
|--|--|--|
|page_type|è·å–æ•°æ®çš„ç±»å‹ä¸ºæ–‡ç« è¿˜æ˜¯è§†é¢‘ï¼Œ==è§†é¢‘ä¸º0==ï¼Œ==æ–‡ç« ä¸º1==|å¦|
|user_id|è·å–é‚£ä¸ªç”¨æˆ·çš„æ•°æ®ï¼Œåœ¨ç”¨æˆ·é“¾æ¥ä¸­è·å–user_idï¼šhttps://www.toutiao.com/c/user/==3410443345==/#mid=3413306633|å¦|
|max_behot_time|è¿ç»­è·å–ç”¨æˆ·çš„æ•°æ®ï¼Œç”¨äºèµ–åŠ è½½ä¸Šï¼Œç¬¬ä¸€æ¬¡å€¼é»˜è®¤ä¸º0ï¼Œåç»­çš„å€¼ä¸ºä¸Šä¸€æ¬¡è¿”å›æ•°æ®ä¸­çš„max_behot_timeçš„å€¼|å¦|
|count|å•æ¬¡è¿”å›æœ€å¤§çš„æ•°æ®é‡ï¼Œé»˜è®¤å€¼ä¸º20|å¦|
|as|æ¯ä¸€æ¬¡è¯·æ±‚çš„é“¾æ¥æ˜¯å¦æ˜¯æœ€è¿‘çš„æ—¶é—´|æ˜¯|
|cp|ä¸ä¸ŠåŒç†|æ˜¯|
|_signature|ç”¨äºåˆ¤æ–­user_idå’Œmax_behot_timeçš„å€¼è·Ÿé“¾æ¥å’Œheadersçš„å‚æ•°çš„å€¼æ˜¯å¦ç›¸ç­‰|æ˜¯|

éœ€è¦æ³¨æ„çš„Request Headersä¸­cookieçš„å‚æ•°(è§£å†³æ–¹æ³•ï¼šæ‰‹åŠ¨è·å–è¿™äº›å‚æ•°çš„å€¼)ï¼š
|å‚æ•°|ä½œç”¨|å˜åŒ–|åŠ å¯†|
|--|--|--|--|
|tt_webid|æœªçŸ¥|æ ¹æ®æˆ‘çš„è§‚å¯Ÿæ˜¯ä¸€å¤©å˜åŒ–ä¸€æ¬¡|æ˜¯|
|WEATHER_CITY|æ ‡è®°åŸå¸‚|ä¸å˜åŒ–|æ˜¯(urlencode)|
|tt_webid|æœªçŸ¥|åŒä¸Štt_webidä¸€æ ·|æ˜¯|
|csrftoken|ç”¨äºcsrf|åŒä¸Š|æ˜¯|
è¿™æ ·å°±åˆ†æå®Œæ•´ä¸ªç½‘ç«™äº†ï¼Œä¸‹é¢å¼€å§‹å®æˆ˜ã€‚
# çˆ¬å–ä»Šæ—¥å¤´æ¡
çŸ¥é“è¿™äº›åŠ å¯†å‚æ•°åå°±å¼€å§‹å¯¹åŠ å¯†å‚æ•°è¿›è¡Œç ´è§£
### 1.ç ´è§£aså’Œcp
é¦–å…ˆæˆ‘ä»¬å·²ç»çŸ¥é“äº†æ¯æ¬¡çš„è®¿é—®å‚æ•°éƒ½åœ¨å˜åŒ–ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å…ˆæ‰¾å‡ºè¿™äº›å‚æ•°çš„åŠ å¯†ä»£ç ï¼Œä¹Ÿå°±æ˜¯jsä»£ç ã€‚

æœç´¢jsæ–‡ä»¶ä¸­å¸¦æœ‰`as`æˆ–`cp`æˆ–`_signature`å­—ç¬¦çš„æ–‡ä»¶ï¼Œç„¶åå†åˆ†æä»£ç æ˜¯æ€ä¹ˆæ„æˆçš„ã€‚

æœç´¢æ–¹æ³•ï¼š
![æœç´¢æ–¹æ³•](https://img-blog.csdnimg.cn/20191101170258637.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjc5MDc3,size_16,color_FFFFFF,t_70)
è¿›å…¥åå†æŒ‰Ctrl+Få†æ¬¡æœç´¢`_signature`ï¼Œå°±å¯ä»¥çœ‹åˆ°å‚æ•°çš„åŠ å¯†æ–¹æ³•äº†ã€‚
![æœç´¢](https://img-blog.csdnimg.cn/20191101170441760.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjc5MDc3,size_16,color_FFFFFF,t_70)
è¿™æ ·å°±èƒ½æ‰¾åˆ°è¿™ä¸²åŠ å¯†ä»£ç äº†ã€‚
```javascript
function n() {
    var e, i = ascp.getHoney(), t = "";
    return window.TAC && (t = TAC.sign(userInfo.id + "" + d.params.max_behot_time)),
    e = _.extend({}, d.params, {
        as: i.as,
        cp: i.cp,
        _signature: t
    })
}
```
å…¶ä¸­==i.as==å’Œ==i.cp==åˆ†åˆ«å¯¹åº”==as==å’Œ==cp==ï¼Œè€Œ==i==æ˜¯ç”±`ascp.getHoney()`è¿™ä»£ç è¿”å›çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç»§ç»­æ‰¾`ascp.getHoney`,ç»§ç»­æœç´¢`getHoney`å‡½æ•°ã€‚
![æœç´¢](https://img-blog.csdnimg.cn/20191101171111280.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjc5MDc3,size_16,color_FFFFFF,t_70)
```javascript
i.getHoney = function() {
    var e = Math.floor((new Date).getTime() / 1e3)
      , i = e.toString(16).toUpperCase()
      , t = md5(e).toString().toUpperCase();
    if (8 != i.length)
        return {
            as: "479BB4B7254C150",
            cp: "7E0AC8874BB0985"
        };
    for (var o = t.slice(0, 5), n = t.slice(-5), a = "", s = 0; 5 > s; s++)
        a += o[s] + i[s];
    for (var r = "", l = 0; 5 > l; l++)
        r += i[l + 3] + n[l];
    return {
        as: "A1" + a + i.slice(-3),
        cp: i.slice(0, 3) + r + "E1"
    }
}
```
æ ¹æ®è¿™ä¸²JSä»£ç å°†ä»–è½¬æ¢ä¸ºPythonä»£ç å°±å¯ä»¥å¾—å‡º`as`å’Œ`cp`çš„å€¼äº†ï¼Œä¸‹é¢ç»™å‡ºPythonä»£ç ï¼š
```python
import math,time,hashlib

def getHoney():
    e = math.floor(int(str(time.time() * 1000).split('.')[0]) / 1e3)	#è·å–13ä½æ¯«ç§’æ•°ç„¶åé™¤äº1e3å†å‘ä¸‹å–æ•´
    i = str('%X' % e)	#è½¬æ¢eä¸º16è¿›åˆ¶
    m5 = hashlib.md5()
    m5.update(str(e).encode('utf-8'))
    t = str(m5.hexdigest()).upper()	#è¿›è¡Œmd5åŠ å¯†
    if 8 != len(i):
        return {'as':'479BB4B7254C150','cp':'7E0AC8874BB0985'}
    o = t[0:5]
    n = t[-5:]
    a = ""
    r = ""
    for x in range(5):	#äº¤æ¢å­—ç¬¦ä¸²
        a += o[x] + i[x]
        r += i[x + 3] + n[x]
    return {'as':"A1" + a + i[-3:],'cp':i[0:3] + r + "E1"}

if __name__ == '__main__':
	print(getHoney())
```
![è¾“å‡ºç»“æœ](https://img-blog.csdnimg.cn/20191101173413781.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjc5MDc3,size_16,color_FFFFFF,t_70)
### 2.ç ´è§£_signature
æ ¹æ®ä¸Šé¢ç ´è§£==as==å’Œ==cp==æ—¶å€™çš„æˆªå›¾ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹è§ç”Ÿæˆ`_signature`çš„å€¼æ˜¯==t==ï¼Œè€Œç”Ÿæˆtçš„æ–¹æ³•æ˜¯`TAC.sign(userInfo.id + "" + d.params.max_behot_time)`ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æœç´¢`TAC.sign()`æ–¹æ³•ã€‚
![æœç´¢](https://img-blog.csdnimg.cn/20191101170441760.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjc5MDc3,size_16,color_FFFFFF,t_70)
æœç´¢å®Œæˆä¹‹åå‘ç°æ˜¯å¾ˆå¤§ä¸€ä¸²æ··æ·†åŠ å¯†åçš„æ–¹æ³•å®ç°çš„TACï¼Œæƒ³è¦ç ´è§£éœ€è¦èŠ±å¾ˆå¤šæ—¶é—´å»çœ‹ä»£ç ï¼Œæ‰€ä»¥ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘å°±ç”¨execjsç›´æ¥æ‰§è¡Œè¿™ä¸²ä»£ç å°±å¯ä»¥äº†ã€‚
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20191101174311270.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjc5MDc3,size_16,color_FFFFFF,t_70)
jsæºä»£ç ï¼š
```javascript
Function(function(e) {
    return 'e(e,a,r){(b[e]||(b[e]=t("x,y","x "+e+" y")(r,a)}a(e,a,r){(k[r]||(k[r]=t("x,y","new x[y]("+Array(r+1).join(",x[y]")(1)+")")(e,a)}r(e,a,r){n,t,s={},b=s.d=r?r.d+1:0;for(s["$"+b]=s,t=0;t<b;t)s[n="$"+t]=r[n];for(t=0,b=s=a;t<b;t)s[t]=a[t];c(e,0,s)}c(t,b,k){u(e){v[x]=e}f{g=,ting(bg)}l{try{y=c(t,b,k)}catch(e){h=e,y=l}}for(h,y,d,g,v=[],x=0;;)switch(g=){case 1:u(!)4:f5:u((e){a=0,r=e;{c=a<r;c&&u(e[a]),c}}(6:y=,u((y8:if(g=,lg,g=,y===c)b+=g;else if(y!==l)y9:c10:u(s(11:y=,u(+y)12:for(y=f,d=[],g=0;g<y;g)d[g]=y.charCodeAt(g)^g+y;u(String.fromCharCode.apply(null,d13:y=,h=delete [y]14:59:u((g=)?(y=x,v.slice(x-=g,y:[])61:u([])62:g=,k[0]=65599*k[0]+k[1].charCodeAt(g)>>>065:h=,y=,[y]=h66:u(e(t[b],,67:y=,d=,u((g=).x===c?r(g.y,y,k):g.apply(d,y68:u(e((g=t[b])<"<"?(b--,f):g+g,,70:u(!1)71:n72:+f73:u(parseInt(f,3675:if(){bcase 74:g=<<16>>16g76:u(k[])77:y=,u([y])78:g=,u(a(v,x-=g+1,g79:g=,u(k["$"+g])81:h=,[f]=h82:u([f])83:h=,k[]=h84:!085:void 086:u(v[x-1])88:h=,y=,h,y89:u({e{r(e.y,arguments,k)}e.y=f,e.x=c,e})90:null91:h93:h=0:;default:u((g<<16>>16)-16)}}n=this,t=n.Function,s=Object.keys||(e){a={},r=0;for(c in e)a[r]=c;a=r,a},b={},k={};r'.replace(/[-]/g, function(i) {
        return e[15 & i.charCodeAt(0)]
    })
}("v[x++]=v[--x]t.charCodeAt(b++)-32function return ))++.substrvar .length(),b+=;break;case ;break}".split("")))()('gr$Daten Ğ˜b/s!l yÍ’yÄ¹g,(lfi~ah`{mv,-n|jqewVxp{rvmmx,&effkx[!cs"l".Pq%widthl"@q&heightl"vr*getContextx$"2d[!cs#l#,*;?|u.|uc{uq$fontl#vr(fillTextx$$é¾˜à¸‘à¸ ê²½2<[#c}l#2q*shadowBlurl#1q-shadowOffsetXl#$$limeq+shadowColorl#vr#arcx88802[%c}l#vr&strokex[ c}l"v,)}eOmyoZB]mx[ cs!0s$l$Pb<k7l l!r&lengthb%^l$1+s$jl  s#i$1ek1s$gr#tack4)zgr#tac$! +0o![#cj?o ]!l$b%s"o ]!l"l$b*b^0d#>>>s!0s%yA0s"l"l!r&lengthb<k+l"^l"1+s"jl  s&l&z0l!$ +["cs\'(0l#i\'1ps9wxb&s() &{s)/s(gr&Stringr,fromCharCodes)0s*yWl ._b&s o!])l l Jb<k$.aj;l .Tb<k$.gj/l .^b<k&i"-4j!+& s+yPo!]+s!l!l Hd>&l!l Bd>&+l!l <d>&+l!l 6d>&+l!l &+ s,y=o!o!]/q"13o!l q"10o!],l 2d>& s.{s-yMo!o!]0q"13o!]*Ld<l 4d#>>>b|s!o!l q"10o!],l!& s/yIo!o!].q"13o!],o!]*Jd<l 6d#>>>b|&o!]+l &+ s0l-l!&l-l!i\'1z141z4b/@d<l"b|&+l-l(l!b^&+l-l&zl\'g,)gk}ejo{cm,)|yn~Lij~em["cl$b%@d<l&zl\'l $ +["cl$b%b|&+l-l%8d<@b|l!b^&+ q$sign ', [TAC = {}]);
```
ç”±äºpythonæ²¡æœ‰æµè§ˆå™¨çš„userAgentï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—å¯¹ä»£ç è¿›è¡Œä¸€ç‚¹æ”¹å˜ï¼Œè®©ä»–æ¥é€‚åº”æˆ‘ä»¬pythonä»£ç ã€‚
```javascript
function tac(userid){
    Function(function(e) {
        global.navigator={};	//å£°æ˜ä¸€ä¸ªæµè§ˆå™¨å¾—navigator
        global.navigator.userAgent = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.70 Safari/537.36";	//ç»™navigatoræ·»åŠ ä¸€ä¸ªuserAgentï¼Œè®©ä¸‹é¢æ··æ·†èƒ½å¤Ÿæ­£å¸¸è¯»å–userAgentä¿¡æ¯ï¼Œæ­¤userAgentå¿…é¡»å’Œpythonä»£ç ä¸­çš„headersé‡Œçš„userAgentä¸€æ¨¡ä¸€æ ·ã€‚
        return 'e(e,a,r){(b[e]||(b[e]=t("x,y","x "+e+" y")(r,a)}a(e,a,r){(k[r]||(k[r]=t("x,y","new x[y]("+Array(r+1).join(",x[y]")(1)+")")(e,a)}r(e,a,r){n,t,s={},b=s.d=r?r.d+1:0;for(s["$"+b]=s,t=0;t<b;t)s[n="$"+t]=r[n];for(t=0,b=s=a;t<b;t)s[t]=a[t];c(e,0,s)}c(t,b,k){u(e){v[x]=e}f{g=,ting(bg)}l{try{y=c(t,b,k)}catch(e){h=e,y=l}}for(h,y,d,g,v=[],x=0;;)switch(g=){case 1:u(!)4:f5:u((e){a=0,r=e;{c=a<r;c&&u(e[a]),c}}(6:y=,u((y8:if(g=,lg,g=,y===c)b+=g;else if(y!==l)y9:c10:u(s(11:y=,u(+y)12:for(y=f,d=[],g=0;g<y;g)d[g]=y.charCodeAt(g)^g+y;u(String.fromCharCode.apply(null,d13:y=,h=delete [y]14:59:u((g=)?(y=x,v.slice(x-=g,y:[])61:u([])62:g=,k[0]=65599*k[0]+k[1].charCodeAt(g)>>>065:h=,y=,[y]=h66:u(e(t[b],,67:y=,d=,u((g=).x===c?r(g.y,y,k):g.apply(d,y68:u(e((g=t[b])<"<"?(b--,f):g+g,,70:u(!1)71:n72:+f73:u(parseInt(f,3675:if(){bcase 74:g=<<16>>16g76:u(k[])77:y=,u([y])78:g=,u(a(v,x-=g+1,g79:g=,u(k["$"+g])81:h=,[f]=h82:u([f])83:h=,k[]=h84:!085:void 086:u(v[x-1])88:h=,y=,h,y89:u({e{r(e.y,arguments,k)}e.y=f,e.x=c,e})90:null91:h93:h=0:;default:u((g<<16>>16)-16)}}n=this,t=n.Function,s=Object.keys||(e){a={},r=0;for(c in e)a[r]=c;a=r,a},b={},k={};r'.replace(/[-]/g, function(i) {
            return e[15 & i.charCodeAt(0)]
        })
    }("v[x++]=v[--x]t.charCodeAt(b++)-32function return ))++.substrvar .length(),b+=;break;case ;break}".split("")))()('gr$Daten Ğ˜b/s!l yÍ’yÄ¹g,(lfi~ah`{mv,-n|jqewVxp{rvmmx,&effkx[!cs"l".Pq%widthl"@q&heightl"vr*getContextx$"2d[!cs#l#,*;?|u.|uc{uq$fontl#vr(fillTextx$$é¾˜à¸‘à¸ ê²½2<[#c}l#2q*shadowBlurl#1q-shadowOffsetXl#$$limeq+shadowColorl#vr#arcx88802[%c}l#vr&strokex[ c}l"v,)}eOmyoZB]mx[ cs!0s$l$Pb<k7l l!r&lengthb%^l$1+s$jl  s#i$1ek1s$gr#tack4)zgr#tac$! +0o![#cj?o ]!l$b%s"o ]!l"l$b*b^0d#>>>s!0s%yA0s"l"l!r&lengthb<k+l"^l"1+s"jl  s&l&z0l!$ +["cs\'(0l#i\'1ps9wxb&s() &{s)/s(gr&Stringr,fromCharCodes)0s*yWl ._b&s o!])l l Jb<k$.aj;l .Tb<k$.gj/l .^b<k&i"-4j!+& s+yPo!]+s!l!l Hd>&l!l Bd>&+l!l <d>&+l!l 6d>&+l!l &+ s,y=o!o!]/q"13o!l q"10o!],l 2d>& s.{s-yMo!o!]0q"13o!]*Ld<l 4d#>>>b|s!o!l q"10o!],l!& s/yIo!o!].q"13o!],o!]*Jd<l 6d#>>>b|&o!]+l &+ s0l-l!&l-l!i\'1z141z4b/@d<l"b|&+l-l(l!b^&+l-l&zl\'g,)gk}ejo{cm,)|yn~Lij~em["cl$b%@d<l&zl\'l $ +["cl$b%b|&+l-l%8d<@b|l!b^&+ q$sign ', [TAC = {}]);
    var signs = TAC.sign(userid);
    return signs
}
```
åœ¨æ‰§è¡Œä¸Šé¢è¿™ä¸²jsä»£ç å‰è¯·å…ˆæ›´æ¢ä¸€ä¸ª`jsç¯å¢ƒ`ï¼Œé»˜è®¤`execjs`ä½¿ç”¨çš„æ˜¯windowsç³»ç»Ÿçš„`JScript`ï¼Œè¿™ä¸ª`jsç¯å¢ƒ`ä¸é€‚åˆè¿™ä¸²ä»£ç ï¼Œæ‰€ä»¥å®‰è£…ä¸€ä¸ª`nodejsç¯å¢ƒ`ï¼Œç„¶åé‡å¯ä¸€ä¸‹`pycharm`å°±å¯ä»¥äº†ã€‚
æŠŠè¿™ä¸²jsä»£ç ä¿å­˜ä¸ºjsæ–‡ä»¶ï¼Œç„¶åç”¨pythonæ¥è¿›è¡Œæ‰§è¡Œï¼Œä¸‹é¢è½¬æ¢ä¸ºpythonä»£ç ã€‚
```python
import execjs

def get_signature(user_id,max_behot_time):
    with open('newsign.js') as f:
        jsData = f.read()
    execjs.get()
    ctx = execjs.compile(jsData).call('tac',str(user_id) + str(max_behot_time))  #å¤åŸTAC.sign(userInfo.id + "" + i.param.max_behot_time)
    return ctx

if __name__ == '__main__':
	user_id = 'https://www.toutiao.com/c/user/3410443345/#mid=3413306633'.split('/')[-2]	#è·å–user_id
	print(get_signature(user_id,0))
```
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20191101175214195.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjc5MDc3,size_16,color_FFFFFF,t_70)
è¿™ä¸‰ä¸ªåŠ å¯†å‚æ•°ç ´è§£å®Œäº†ï¼Œé‚£ä¹ˆå°±å¤§åŠŸå‘Šæˆäº†ã€‚
### 3.è·å–æ•°æ®
ä¸Šé¢å·²ç»ä»‹ç»å®Œäº†æ‰€æœ‰çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥è¿™é‡Œå°±ä¸å¤šè¯´åºŸè¯äº†ï¼Œç›´æ¥ä¸Šä»£ç äº†ã€‚
```python
import requests,math,time,hashlib,execjs,json

#è·å–_signatureå‚æ•°
def get_signature(user_id,max_behot_time):
    with open('newsign.js') as f:
        jsData = f.read()
    execjs.get()
    ctx = execjs.compile(jsData).call('tac',str(user_id) + str(max_behot_time))  #å¤åŸTAC.sign(userInfo.id + "" + i.param.max_behot_time)
    return ctx

#è·å–aså’Œcpå‚æ•°
def getHoney():
    e = math.floor(int(str(time.time() * 1000).split('.')[0]) / 1e3)
    i = str('%X' % e)
    m1 = hashlib.md5()
    m1.update(str(e).encode('utf-8'))
    t = str(m1.hexdigest()).upper()
    if 8 != len(i):
        return {
            'as':'479BB4B7254C150',
            'cp':'7E0AC8874BB0985'
        }
    o = t[0:5]
    n = t[-5:]
    a = ""
    r = ""
    for x in range(5):
        a += o[x] + i[x]
        r += i[x + 3] + n[x]
    return {'as':"A1" + a + i[-3:],'cp':i[0:3] + r + "E1"}

#è·å–ç½‘ç«™apiçš„jsonæ•°æ®
def get_json(user_id,max_behot_time,as_cp,signature,page_type):
    #page_typeä¸º0æ˜¯çˆ¬å–è§†é¢‘å†…å®¹ï¼Œä¸º1æ˜¯çˆ¬å–æ–‡ç« å†…å®¹
    headers = {
        'authority': 'www.toutiao.com',
        'method': 'GET',
        'path': '/c/user/article/?page_type={page_type}&user_id={user_id}&max_behot_time={max_behot_time}&count=20&as={as}&cp={cp}&_signature={signature}'.format(page_type=page_type,user_id=user_id,max_behot_time=max_behot_time,signature=signature, **as_cp),
        'scheme': 'https',
        'accept': 'application/json, text/javascript',
        'accept-encoding': 'gzip, deflate, br',
        'accept-language': 'zh-CN,zh;q=0.9',
        'content-type': 'application/x-www-form-urlencoded',
        'cookie': 'tt_webid=6753859293584737805; WEATHER_CITY=%E5%8C%97%E4%BA%AC; tt_webid=6753859293584737805; csrftoken=60ed6e0a8271872b7d0ab6b864bd6611; __tasessionId=eqzqwzzav1572574450156',
        'referer': 'https://www.toutiao.com/c/user/3410443345/',
        'sec-fetch-mode': 'cors',
        'sec-fetch-site': 'same-origin',
        'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.70 Safari/537.36',
        'x-requested-with': 'XMLHttpRequest'
    }
    url = 'https://www.toutiao.com/c/user/article/?page_type={page_type}&user_id={user_id}&max_behot_time={max_behot_time}&count=20&as={as}&cp={cp}&_signature={signature}'.format(page_type=page_type,user_id=user_id,max_behot_time=max_behot_time,signature=signature, **as_cp)
    response = requests.get(url, headers=headers)
    resp_json = json.loads(response.text)
    return resp_json

if __name__ == '__main__':
    url = 'https://www.toutiao.com/c/user/3410443345/#mid=3413306633'  # urlä¸ºç”¨æˆ·æ–‡ç« å’Œè§†é¢‘çš„æº
    user_id = url.split('/')[-2]  # è·å–ç”¨æˆ·user_idï¼Œç­‰åŒäºjsä¸­çš„userInfo.id
    max_behot_time = 0  # _signatureå‚æ•°ç”Ÿæˆéœ€è¦ï¼Œå¹¶ä¸”èµ–åŠ è½½æ—¶ä¹Ÿéœ€è¦æ­¤å‚æ•°
    page_type = 1   #0ä¸ºæ–‡ç« ï¼Œ1ä¸ºè§†é¢‘
    as_cp = getHoney()  #è·å–aså’Œcpå€¼
    signature = get_signature(user_id,max_behot_time) #è·å–_signatureå€¼
    toutiao_json = get_json(user_id,max_behot_time,as_cp,signature,page_type)   #è·å–ä»Šæ—¥å¤´æ¡æ–‡ç« æ•°æ®
    print(json.dumps(toutiao_json,ensure_ascii=False,indent=4,sort_keys=True))
```
![æ¼”ç¤ºå›¾](https://img-blog.csdnimg.cn/20191101181706930.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjc5MDc3,size_16,color_FFFFFF,t_70)
### 4.è·å–èµ–åŠ è½½æ•°æ®(å®Œæ•´ç‰ˆ)
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20191101182201451.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjc5MDc3,size_16,color_FFFFFF,t_70)
ä¸Šå›¾å°±æ˜¯è·å–åˆ°ç©ºæ•°æ®ï¼Œæ‰€ä»¥ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜åŠ äº†tryæ¥è¿›è¡Œæ§åˆ¶ã€‚
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20191101183332541.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjc5MDc3,size_16,color_FFFFFF,t_70)
å®Œæ•´ä»£ç ï¼š
```python
import requests,math,time,hashlib,execjs,json

#è·å–_signatureå‚æ•°
def get_signature(user_id,max_behot_time):
    with open('newsign.js') as f:
        jsData = f.read()
    execjs.get()
    ctx = execjs.compile(jsData).call('tac',str(user_id) + str(max_behot_time))  #å¤åŸTAC.sign(userInfo.id + "" + i.param.max_behot_time)
    return ctx

#è·å–aså’Œcpå‚æ•°
def getHoney():
    e = math.floor(int(str(time.time() * 1000).split('.')[0]) / 1e3)
    i = str('%X' % e)
    m1 = hashlib.md5()
    m1.update(str(e).encode('utf-8'))
    t = str(m1.hexdigest()).upper()
    if 8 != len(i):
        return {
            'as':'479BB4B7254C150',
            'cp':'7E0AC8874BB0985'
        }
    o = t[0:5]
    n = t[-5:]
    a = ""
    r = ""
    for x in range(5):
        a += o[x] + i[x]
        r += i[x + 3] + n[x]
    return {'as':"A1" + a + i[-3:],'cp':i[0:3] + r + "E1"}

#è·å–ç½‘ç«™apiçš„jsonæ•°æ®
def get_json(user_id,max_behot_time,as_cp,signature,page_type):
    #page_typeä¸º0æ˜¯çˆ¬å–è§†é¢‘å†…å®¹ï¼Œä¸º1æ˜¯çˆ¬å–æ–‡ç« å†…å®¹
    headers = {
        'authority': 'www.toutiao.com',
        'method': 'GET',
        'path': '/c/user/article/?page_type={page_type}&user_id={user_id}&max_behot_time={max_behot_time}&count=20&as={as}&cp={cp}&_signature={signature}'.format(page_type=page_type,user_id=user_id,max_behot_time=max_behot_time,signature=signature, **as_cp),
        'scheme': 'https',
        'accept': 'application/json, text/javascript',
        'accept-encoding': 'gzip, deflate, br',
        'accept-language': 'zh-CN,zh;q=0.9',
        'content-type': 'application/x-www-form-urlencoded',
        'cookie': 'tt_webid=6753859293584737805; WEATHER_CITY=%E5%8C%97%E4%BA%AC; tt_webid=6753859293584737805; csrftoken=60ed6e0a8271872b7d0ab6b864bd6611; __tasessionId=eqzqwzzav1572574450156',
        'referer': 'https://www.toutiao.com/c/user/3410443345/',
        'sec-fetch-mode': 'cors',
        'sec-fetch-site': 'same-origin',
        'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.70 Safari/537.36',
        'x-requested-with': 'XMLHttpRequest'
    }
    url = 'https://www.toutiao.com/c/user/article/?page_type={page_type}&user_id={user_id}&max_behot_time={max_behot_time}&count=20&as={as}&cp={cp}&_signature={signature}'.format(page_type=page_type,user_id=user_id,max_behot_time=max_behot_time,signature=signature, **as_cp)
    response = requests.get(url, headers=headers)
    resp_json = json.loads(response.text)
    return resp_json

if __name__ == '__main__':
    url = 'https://www.toutiao.com/c/user/3410443345/#mid=3413306633'  # urlä¸ºç”¨æˆ·æ–‡ç« å’Œè§†é¢‘çš„æº
    user_id = url.split('/')[-2]  # è·å–ç”¨æˆ·user_idï¼Œç­‰åŒäºjsä¸­çš„userInfo.id
    max_behot_time = 0  # _signatureå‚æ•°ç”Ÿæˆéœ€è¦ï¼Œå¹¶ä¸”èµ–åŠ è½½æ—¶ä¹Ÿéœ€è¦æ­¤å‚æ•°
    isDown = True  # ä¸€ç›´è·å–æ•°æ®
    page_type = 1   #0ä¸ºè§†é¢‘ï¼Œ1ä¸ºæ–‡ç« 
    while isDown:	#è§£å†³èµ–åŠ è½½é—®é¢˜
        as_cp = getHoney()
        signature = get_signature(user_id, max_behot_time)
        toutiao_json = get_json(user_id, max_behot_time, as_cp, signature,page_type)
        # ç”±äºä»Šæ—¥å¤´æ¡çš„åçˆ¬è™«æœºåˆ¶ï¼Œæœ‰æ—¶ä¼šè·å–åˆ°ç©ºçš„æ•°æ®ï¼Œæ‰€ä»¥éœ€è¦ç”¨tryæ¥æ§åˆ¶ï¼Œä¸€èˆ¬æ¯”ä¾‹æ˜¯3ï¼š1æ‰€ä»¥æ˜¯è®¿é—®3æ¬¡æœ‰ä¸€æ¬¡è·å¾—æ•°æ®
        if page_type:
            try:
                max_behot_time = toutiao_json['next']['max_behot_time']     #æ•°æ®ä¸ºç©ºå°±æ²¡æœ‰è¿™ä¸ªé€‰é¡¹ä»è€Œå¼•å‘try
                print('æ–‡ç« æ•°æ®ï¼š%s' % str(toutiao_json))
                has_more = toutiao_json['has_more'] #è·å–æ˜¯å¦è¿˜æœ‰ä¸‹ä¸€é¡µæ•°æ®
                if not has_more:    #ç”¨æ¥åˆ¤æ–­æ˜¯å¦æ²¡æœ‰ä¸‹ä¸€é¡µäº†
                    isDown = False
                    break
            except Exception as e:
                continue
        else:
            try:
                max_behot_time = toutiao_json['next']['max_behot_time']  # æ•°æ®ä¸ºç©ºå°±æ²¡æœ‰è¿™ä¸ªé€‰é¡¹ä»è€Œå¼•å‘try
                print('è§†é¢‘æ•°æ®ï¼š%s' % str(toutiao_json))
                has_more = toutiao_json['has_more'] #è·å–æ˜¯å¦è¿˜æœ‰ä¸‹ä¸€é¡µæ•°æ®
                if not has_more:    #ç”¨æ¥åˆ¤æ–­æ˜¯å¦æ²¡æœ‰ä¸‹ä¸€é¡µäº†
                    isDown = False
                    break
            except Exception as e:
                continue
```
# å£°æ˜ï¼šæœ¬æ–‡ä»…ä¾›å­¦ä¹ äº¤æµä½¿ç”¨ï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œè¿è€…åæœè‡ªè´Ÿã€‚